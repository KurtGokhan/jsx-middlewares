"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[384],{5849:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>b,contentTitle:()=>w,default:()=>y,frontMatter:()=>x,metadata:()=>t,toc:()=>j});const t=JSON.parse('{"id":"examples/memo","title":"Memo Directive","description":"This directive memoizes a component with React.memo to avoid unnecessary rerenders.","source":"@site/docs/examples/memo.mdx","sourceDirName":"examples","slug":"/examples/memo","permalink":"/jsx-middlewares/examples/memo","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5},"sidebar":"tutorialSidebar","previous":{"title":"Ripple","permalink":"/jsx-middlewares/examples/ripple"},"next":{"title":"Active Wheel Event Handler Directive","permalink":"/jsx-middlewares/examples/on-wheel-active"}}');var s=r(2540),o=r(3023),i=r(3696),d=r(685);const c=(0,r(1328).U)(),{jsx:a,jsxDEV:l,jsxs:m}=c,u=new Map;function p(e){let{children:n}=e;const r=(0,i.useRef)(0);return m("p",{children:[a("span",{children:n}),m("span",{children:["\xa0Render count: ",++r.current]})]})}function h(){const[e,n]=(0,i.useState)(0);return(0,i.useEffect)((()=>{const e=setInterval((()=>{n((e=>e+1))}),1e3);return()=>{clearInterval(e)}}),[]),m("div",{children:[m("p",{children:["Timer: ",e]}),a(p,{children:"This is not memoed."}),a(p,{$memo:!0,children:"This is memoed."})]})}function f(){return a(d.A,{children:a(h,{})})}c.addMiddlewares((function(e,n,r,t){let{$memo:s,...o}=r;if(s&&"function"==typeof n){let r=u.get(n);return r||(r=(0,i.memo)(n),u.set(n,r)),e(r,o,t)}return e(n,o,t)}));const x={sidebar_position:5},w="Memo Directive",b={},j=[{value:"Usage",id:"usage",level:2},{value:"Typescript types",id:"typescript-types",level:2}];function v(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"memo-directive",children:"Memo Directive"})}),"\n",(0,s.jsxs)(n.p,{children:["This directive memoizes a component with ",(0,s.jsx)(n.code,{children:"React.memo"})," to avoid unnecessary rerenders."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"const memoMap = new Map();\n\nfunction memoMiddleware(next, type, { $memo, ...props }, key) {\n  if ($memo && typeof type === 'function') {\n    let memoed = memoMap.get(type);\n    if (!memoed) {\n      memoed = React.memo(type);\n      memoMap.set(type, memoed);\n    }\n\n    return next(memoed, props, key);\n  }\n\n  return next(type, props, key);\n}\n\naddMiddlewares(memoMiddleware);\n"})}),"\n",(0,s.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsx",children:"function App() {\n  // ...\n  return (\n    <div>\n      <Memoed>This is not memoed.</Memoed>\n      <Memoed $memo>This is memoed.</Memoed>\n    </div>\n  );\n}\n"})}),"\n",(0,s.jsx)(f,{}),"\n",(0,s.jsx)(n.h2,{id:"typescript-types",children:"Typescript types"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"declare module 'react' {\n  interface Attributes {\n    $memo?: boolean;\n  }\n}\n"})})]})}function y(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(v,{...e})}):v(e)}},685:(e,n,r)=>{r.d(n,{A:()=>i});var t=r(1750);r(3696);const s={browserWindow:"browserWindow_my1Q",browserWindowHeader:"browserWindowHeader_jXSR",row:"row_KZDM",buttons:"buttons_uHc7",right:"right_oyze",browserWindowAddressBar:"browserWindowAddressBar_Pd8y",dot:"dot_giz1",browserWindowMenuIcon:"browserWindowMenuIcon_Vhuh",bar:"bar_rrRL",browserWindowBody:"browserWindowBody_Idgs"};var o=r(2540);function i(e){let{children:n,minHeight:r,url:i="http://localhost:3000",style:d,bodyStyle:c}=e;return(0,o.jsxs)("div",{className:s.browserWindow,style:{...d,minHeight:r},children:[(0,o.jsxs)("div",{className:s.browserWindowHeader,children:[(0,o.jsxs)("div",{className:s.buttons,children:[(0,o.jsx)("span",{className:s.dot,style:{background:"#f25f58"}}),(0,o.jsx)("span",{className:s.dot,style:{background:"#fbbe3c"}}),(0,o.jsx)("span",{className:s.dot,style:{background:"#58cb42"}})]}),(0,o.jsx)("div",{className:(0,t.A)(s.browserWindowAddressBar,"text--truncate"),children:i}),(0,o.jsx)("div",{className:s.browserWindowMenuIcon,children:(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:s.bar}),(0,o.jsx)("span",{className:s.bar}),(0,o.jsx)("span",{className:s.bar})]})})]}),(0,o.jsx)("div",{className:s.browserWindowBody,style:c,children:n})]})}},1328:(e,n,r)=>{function t(e,n,r){return s([],void 0,e,n,r)}function s(e,n,r,t,o){let i,d,c;void 0===e&&(e=[]),t??=r,o??=r;const a=[],l=e=>a.push(e);function m(){i=u(r?.bind(null)),d=u(t?.bind(null)),c=function(e,n,r,t,s,i){return u((function(e,n,r){return o(e,n,r,t,s,i)}))(e,n,r)};for(const e of a)e()}function u(n){let r=n;r&&(r.context=p,r.original=n);for(let t=0;t<e.length;t++){const s=e[t];s&&(r=s.bind(null,r),r.context=p,r.original=n)}return r}n?.(m);const p={addMiddlewares:function(){return e.push(...arguments),m(),p},removeMiddlewares:function(){for(var n=arguments.length,r=new Array(n),t=0;t<n;t++)r[t]=arguments[t];for(const s of r){const n=e.indexOf(s);n>-1&&e.splice(n,1)}return m(),p},clearMiddlewares:function(){return e.length=0,m(),p},jsxClassic:function(e,n){let r;({key:r,...n}=n||{});for(var t=arguments.length,s=new Array(t>2?t-2:0),o=2;o<t;o++)s[o-2]=arguments[o];if(null!=s&&s.length>0){if(1===s.length)return n.children=s[0],i(e,n,r);n.children=s}return d(e,n,r)},jsx:function(e,n,r){return i(e,n,r)},jsxs:function(e,n,r){return d(e,n,r)},jsxDEV:function(e,n,r,t,s,o){return c(e,n,r,t,s,o)},clone:function(n,i,d){return s(e,l,n||r,i||t,d||o)}};return m(),p}r.d(n,{U:()=>i});var o=r(2540);function i(){return t(o.jsx,o.jsxs)}},3023:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>d});var t=r(3696);const s={},o=t.createContext(s);function i(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);